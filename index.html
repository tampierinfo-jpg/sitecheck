<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SiteCheck â€“ iPad</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f4f4f9;padding:20px}
    .wrap{max-width:600px;margin:0 auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,.06)}
    h1{text-align:center;margin-top:0}
    input,textarea{width:100%;padding:15px;margin:12px 0;border-radius:8px;border:1px solid #ccc;font-size:23px}
    textarea{min-height:120px}
    button{padding:12px 24px;margin:8px 0;cursor:pointer;font-size:20px;border-radius:10px;border:1px solid #2e6de8;background:#3b82f6;color:#fff}
    .result{margin-top:15px;padding:12px;border-radius:8px;font-size:20px}
    .ok{background:#d4edda;color:#155724}
    .warn{background:#fff3cd;color:#856404}
    .bad{background:#f8d7da;color:#721c24}
    .traffic{display:flex;justify-content:center;gap:10px;margin:15px 0}
    .light{width:20px;height:20px;border-radius:50%;background:#ccc}
    .red{background:red}.yellow{background:orange}.green{background:green}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ðŸ”’ SiteCheck â€“ iPad</h1>

    <div class="traffic">
      <div id="red" class="light"></div>
      <div id="yellow" class="light"></div>
      <div id="green" class="light"></div>
    </div>

    <input id="single" type="text" placeholder="https://beispiel.de/login">
    <button id="checkOne">PrÃ¼fen</button>

    <h3>Liste prÃ¼fen</h3>
    <textarea id="list" placeholder="Eine URL pro Zeile"></textarea>
    <button id="checkList">Liste prÃ¼fen</button>

    <div id="out"></div>
  </div>

  <script>
    const inputOne=document.getElementById("single");
    const btnOne=document.getElementById("checkOne");
    const areaList=document.getElementById("list");
    const btnList=document.getElementById("checkList");
    const out=document.getElementById("out");

    function setTraffic(state){
      red.className=yellow.className=green.className="light";
      if(state==="bad")   red.classList.add("red");
      if(state==="warn")  yellow.classList.add("yellow");
      if(state==="ok")    green.classList.add("green");
    }
    const red=document.getElementById("red");
    const yellow=document.getElementById("yellow");
    const green=document.getElementById("green");

    function renderResult(container,res){
      const div=document.createElement("div");
      div.className="result "+res.lamp;
      div.innerHTML=`<strong>${res.url}</strong><br>Status: ${res.label}`;
      container.appendChild(div);
    }

    function ensureUrl(s){
      let t=(s||"").trim();
      if(!/^https?:\/\//i.test(t)) t="https://"+t;
      return t;
    }

    let blacklist=[];
    fetch("blacklist.json")
      .then(r=>r.json())
      .then(data=>blacklist=data.domains||[])
      .catch(e=>console.error("Blacklist konnte nicht geladen werden:",e));

    function isBlacklisted(url){
      try{
        const host=new URL(url).hostname.replace(/^www\./,"");
        return blacklist.some(d=>host.endsWith(d));
      }catch(_){return false;}
    }

    function score(u){
      if(isBlacklisted(u)) return {url:u,lamp:"bad",label:"GefÃ¤hrlich (Blacklist)"};
      return {url:u,lamp:"ok",label:"OK"};
    }

    btnOne.onclick=()=>{
      out.innerHTML="";
      const u=ensureUrl(inputOne.value);
      if(!u){alert("Bitte gib eine gÃ¼ltige URL ein.");return;}
      const res=score(u); setTraffic(res.lamp); renderResult(out,res);
    };

    btnList.onclick=()=>{
      out.innerHTML="";
      const lines=areaList.value.split(/\n+/).map(s=>s.trim()).filter(Boolean);
      if(!lines.length){alert("Bitte gib mindestens eine URL ein.");return;}
      let worst="ok";
      for(const line of lines){
        const u=ensureUrl(line);
        const res=score(u);
        renderResult(out,res);
        if(res.lamp==="bad") worst="bad";
        else if(res.lamp==="warn"&&worst!=="bad") worst="warn";
      }
      setTraffic(worst);
    };

    setTraffic("ok");
  </script>
</body>
</html>
